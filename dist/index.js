"use strict";function ___$insertStyle(n){if(n&&"undefined"!=typeof window){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=n,document.head.appendChild(e),n}}var React=require("react"),extendStatics=function(n,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t])})(n,e)};function __extends(n,e){function t(){this.constructor=n}extendStatics(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}var __assign=function(){return(__assign=Object.assign||function(n){for(var e,t=1,a=arguments.length;t<a;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function __awaiter(n,e,t,a){return new(t||(t=Promise))(function(o,s){function i(n){try{l(a.next(n))}catch(n){s(n)}}function r(n){try{l(a.throw(n))}catch(n){s(n)}}function l(n){n.done?o(n.value):new t(function(e){e(n.value)}).then(i,r)}l((a=a.apply(n,e||[])).next())})}function __generator(n,e){var t,a,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function r(s){return function(r){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,a&&(o=2&s[0]?a.return:s[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,s[1])).done)return o;switch(a=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,a=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(n,i)}catch(n){s=[6,n],a=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,r])}}}___$insertStyle(".johnnymnemonic.input {\n  position: relative;\n  width: 100%;\n}\n.johnnymnemonic.la-ball-scale {\n  position: absolute;\n  margin: auto;\n  top: 0;\n  bottom: 0;\n  right: 1.5rem;\n}\n.johnnymnemonic.suggestion-list {\n  list-style: none;\n  display: block;\n  position: absolute;\n  margin: 0;\n  padding: 0;\n  width: 91%;\n  font-size: 90%;\n  border: 1px solid #eee;\n  background: #fff;\n  z-index: 10;\n}\n.johnnymnemonic.suggestion-list li {\n  padding: 0.25rem 0.5rem;\n}\n.johnnymnemonic.suggestion-list li:not(:last-child) {\n  border-bottom: 1px solid #eee;\n}\n\n/*!\n * Load Awesome v1.1.0 (http://github.danielcardoso.net/load-awesome/)\n * Copyright 2015 Daniel Cardoso <@DanielCardoso>\n * Licensed under MIT\n */\n.la-ball-scale,\n.la-ball-scale > div {\n  position: relative;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n}\n\n.la-ball-scale {\n  display: block;\n  font-size: 0;\n  color: #ccc;\n}\n\n.la-ball-scale.la-dark {\n  color: #333;\n}\n\n.la-ball-scale > div {\n  display: inline-block;\n  float: none;\n  background-color: currentColor;\n  border: 0 solid currentColor;\n}\n\n.la-ball-scale {\n  width: 32px;\n  height: 32px;\n}\n\n.la-ball-scale > div {\n  width: 32px;\n  height: 32px;\n  border-radius: 100%;\n  opacity: 0;\n  -webkit-animation: ball-scale 1s 0s ease-in-out infinite;\n  -moz-animation: ball-scale 1s 0s ease-in-out infinite;\n  -o-animation: ball-scale 1s 0s ease-in-out infinite;\n  animation: ball-scale 1s 0s ease-in-out infinite;\n}\n\n.la-ball-scale.la-sm {\n  width: 16px;\n  height: 16px;\n}\n\n.la-ball-scale.la-sm > div {\n  width: 16px;\n  height: 16px;\n}\n\n.la-ball-scale.la-2x {\n  width: 64px;\n  height: 64px;\n}\n\n.la-ball-scale.la-2x > div {\n  width: 64px;\n  height: 64px;\n}\n\n.la-ball-scale.la-3x {\n  width: 96px;\n  height: 96px;\n}\n\n.la-ball-scale.la-3x > div {\n  width: 96px;\n  height: 96px;\n}\n\n/*\n * Animation\n */\n@-webkit-keyframes ball-scale {\n  0% {\n    opacity: 1;\n    -webkit-transform: scale(0);\n    transform: scale(0);\n  }\n  100% {\n    opacity: 0;\n    -webkit-transform: scale(1);\n    transform: scale(1);\n  }\n}\n@-moz-keyframes ball-scale {\n  0% {\n    opacity: 1;\n    -moz-transform: scale(0);\n    transform: scale(0);\n  }\n  100% {\n    opacity: 0;\n    -moz-transform: scale(1);\n    transform: scale(1);\n  }\n}\n@-o-keyframes ball-scale {\n  0% {\n    opacity: 1;\n    -o-transform: scale(0);\n    transform: scale(0);\n  }\n  100% {\n    opacity: 0;\n    -o-transform: scale(1);\n    transform: scale(1);\n  }\n}\n@keyframes ball-scale {\n  0% {\n    opacity: 1;\n    -webkit-transform: scale(0);\n    -moz-transform: scale(0);\n    -o-transform: scale(0);\n    transform: scale(0);\n  }\n  100% {\n    opacity: 0;\n    -webkit-transform: scale(1);\n    -moz-transform: scale(1);\n    -o-transform: scale(1);\n    transform: scale(1);\n  }\n}");var JohnnyMnemonic=function(n){function e(e){var t=n.call(this,e)||this;return t.state={value:"",suggestions:[],suggestionFuncDelay:e.suggestionFuncDelay||250,suggestionFuncTimeout:null,loading:!1,lastOnChangeEvent:null},t.inputRef=React.createRef(),t.ulRef=React.createRef(),t.onChange=t.onChange.bind(t),t.onSuggestionClick=t.onSuggestionClick.bind(t),t.manageFocus=t.manageFocus.bind(t),t.manageKeyDown=t.manageKeyDown.bind(t),t.fetchSuggestions=t.fetchSuggestions.bind(t),t.manageTimeout=t.manageTimeout.bind(t),t}return __extends(e,n),e.prototype.componentDidMount=function(){document.addEventListener("click",this.manageFocus),document.addEventListener("keydown",this.manageKeyDown)},e.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.manageFocus),document.removeEventListener("keydown",this.manageKeyDown)},e.prototype.fetchSuggestions=function(){return __awaiter(this,void 0,void 0,function(){var n,e;return __generator(this,function(t){switch(t.label){case 0:if(!this.state.value)return[3,4];this.setState({loading:!0}),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.props.suggestionFunction(this.state.value)];case 2:return n=t.sent(),this.setState({suggestions:n,loading:!1}),[3,4];case 3:return e=t.sent(),this.setState({suggestions:[],loading:!1}),console.error(e),[3,4];case 4:return[2]}})})},e.prototype.manageTimeout=function(){this.state.suggestionFuncTimeout&&clearTimeout(this.state.suggestionFuncTimeout),this.setState({suggestionFuncTimeout:setTimeout(this.fetchSuggestions,this.state.suggestionFuncDelay)})},e.prototype.manageFocus=function(){var n=document.activeElement,e=this.inputRef.current,t=this.ulRef.current;n===e&&n===t||this.setState({suggestions:[]})},e.prototype.manageKeyDown=function(n){9===n.keyCode&&this.setState({suggestions:[]})},e.prototype.onChange=function(n){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return n.persist(),e=n.target.value,this.setState({value:e,lastOnChangeEvent:n}),this.props.onChange(n),this.manageTimeout(),this.state.value||this.setState({suggestions:[]}),[2]})})},e.prototype.onSuggestionClick=function(n){n.persist();var e=n.currentTarget.dataset.value;this.setState({value:e,suggestions:[]});var t=this.state.lastOnChangeEvent;t.target.value=e,this.props.onChange(t)},e.prototype.render=function(){var n=this;return console.log("render props","props",this.props.value,"state",this.state.value),React.createElement(React.Fragment,null,React.createElement("input",__assign({},this.props,{ref:this.inputRef,type:this.props.type||"text",className:"johnnymnemonic input "+(this.props.className||""),value:this.state.value||this.props.value||"",onChange:this.onChange})),this.state.loading?React.createElement("div",{className:"johnnymnemonic la-ball-scale la-sm"},React.createElement("div",null)):null,this.state.suggestions.length>0?React.createElement("ul",{ref:this.ulRef,className:"johnnymnemonic suggestion-list"},this.state.suggestions.map(function(e){return React.createElement("li",{onClick:n.onSuggestionClick,"data-value":e},e)})):null)},e}(React.Component);module.exports=JohnnyMnemonic;
